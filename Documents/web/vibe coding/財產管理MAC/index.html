<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>財產管理系統</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>🏢 財產管理系統</h1>
            <div class="header-actions">
                <button id="refreshBtn" class="btn btn-primary">
                    <span>🔄</span> 重新整理
                </button>
                <button id="addBtn" class="btn btn-success">
                    <span>➕</span> 新增資產
                </button>
                <button id="exportBtn" class="btn btn-info">
                    <span>📥</span> 匯出Excel
                </button>
            </div>
        </header>

        <!-- 搜尋和篩選區 -->
        <div class="search-section">
            <div class="search-bar">
                <input type="text" id="searchInput" placeholder="🔍 搜尋財產編號、名稱、保管人...">
            </div>
            <div class="filter-group">
                <select id="filterUnit" class="filter-select">
                    <option value="">全部財產單位</option>
                </select>
                <select id="filterKeeper" class="filter-select">
                    <option value="">全部保管人</option>
                </select>
                <select id="filterLocation" class="filter-select">
                    <option value="">全部地點</option>
                </select>
            </div>
        </div>

        <!-- 統計資訊 -->
        <div class="stats-section">
            <div class="stat-card">
                <div class="stat-value" id="totalAssets">0</div>
                <div class="stat-label">總資產數量</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalValue">0</div>
                <div class="stat-label">總金額</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalItems">0</div>
                <div class="stat-label">資產項目</div>
            </div>
        </div>

        <!-- 資料表格 -->
        <div class="table-container">
            <table id="assetsTable">
                <thead>
                    <tr>
                        <th>財產編號</th>
                        <th>財產名稱</th>
                        <th>規格/型號</th>
                        <th>數量</th>
                        <th>財產單位</th>
                        <th>購入/申請日期</th>
                        <th>取得日期</th>
                        <th>取得金額</th>
                        <th>保管單位</th>
                        <th>保管人</th>
                        <th>所在地點</th>
                        <th>供應商</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="assetsTableBody">
                    <tr>
                        <td colspan="13" class="loading">載入中...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 新增/編輯資產對話框 -->
    <div id="assetModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">新增資產</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="assetForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="assetNo">財產編號 *</label>
                            <input type="text" id="assetNo" required>
                        </div>
                        <div class="form-group">
                            <label for="assetName">財產名稱 *</label>
                            <input type="text" id="assetName" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="specification">規格/型號</label>
                            <input type="text" id="specification">
                        </div>
                        <div class="form-group">
                            <label for="quantity">數量</label>
                            <input type="number" id="quantity" min="1" value="1">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="unit">財產單位</label>
                            <input type="text" id="unit">
                        </div>
                        <div class="form-group">
                            <label for="purchaseDate">購入/申請日期</label>
                            <input type="text" id="purchaseDate" placeholder="114/10/20">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="acquireDate">取得日期</label>
                            <input type="text" id="acquireDate" placeholder="114/10/20">
                        </div>
                        <div class="form-group">
                            <label for="amount">取得金額</label>
                            <input type="number" id="amount" min="0">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="department">保管單位</label>
                            <input type="text" id="department">
                        </div>
                        <div class="form-group">
                            <label for="keeper">保管人</label>
                            <input type="text" id="keeper">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="location">所在地點</label>
                            <input type="text" id="location">
                        </div>
                        <div class="form-group">
                            <label for="supplier">供應商</label>
                            <input type="text" id="supplier">
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" id="cancelBtn">取消</button>
                        <button type="submit" class="btn btn-primary">儲存</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html>
